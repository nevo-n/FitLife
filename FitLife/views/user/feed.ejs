<%- include('profileWindow', {user: data.user}) %> <%
data.followingPosts.forEach((post) => { %>
<!-- <%= JSON.stringify(post) %> -->
<div class="card mb-4">
  <div class="card-header">
    <h3><%= post.title %></h3>
    <small class="text-muted"> By <%= post.author.email %> </small>
  </div>
  <div class="card-body">
    <p><%= post.content %></p>
  </div>
  <div class="card-footer">
    <div class="row ml-2 mr-2 justify-content-between">
      <div class="align-items-start">
        <% if(post.author.email == data.user.email) {%>
        <a href="/post/edit/<%= post._id %>" class="text-muted">
          <i class="bi bi-pencil-square"></i>
        </a>
        <%}%>
        <small class="text-muted ml-2">
          <i class="fa fa-heart"></i> <%= post.likes.length %> Likes
        </small>
      </div>
      <div class="m-2 align-items-end">
        <% if(post.liked){%>
            <a href="/post/removeLike/<%=post._id%>" class="btn btn-danger">
          <i class="fas fa-thumbs-down"></i>
        </a>

        <%} else {%>
            <a href="/post/addLike/<%=post._id%>" class="btn btn-primary">
            <i class="fas fa-thumbs-up"></i>
            </a>
        <%}%>
        
      </div>
    </div>
    <div class="comments">
      <% if(post.comments.length == 0) { %>
      <div class="mt-1">
        <span class="text-muted">Be the first to comment</span>
      </div>
      <% } %>
      <div class="mt-2">
        <form action="/post/addComment/<%= post._id%>" method="POST">
          <div class="form-group">
            <textarea
              class="form-control"
              id="commentContent"
              name="comment"
              rows="2"
              required
            ></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Submit</button>
        </form>
      </div>
      <% if(post.comments.length > 0) {%>
        <div class="alert alert-secondary mt-3">
            <h4>Comments</h4>
            <% post.comments.forEach((comment) => { %>
                <hr>
                <p>
                    <strong class="text-muted"><%= comment.user_id.email %></strong>:
                    <span><%= comment.content %></span>
                </p>
        
           <% }); %>
        </div>
      <%} %>
      
    </div>
  </div>
</div>
<% }); %>
